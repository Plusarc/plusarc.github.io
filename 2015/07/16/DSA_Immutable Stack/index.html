<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">










  <meta name="google-site-verification" content="google88d81a02a91db82f">















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico?v=7.1.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico?v=7.1.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico?v=7.1.1">


  <link rel="mask-icon" href="/favicon.ico?v=7.1.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '7.1.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: 'LP2H1MWXO2',
      apiKey: '69bf93a909694ef7f679098292b442ca',
      indexName: 'Plusaber',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Immutable Stack 最近实验需要使用到immutable stack，直接复制创建新的栈时间和空间效率都十分低，这里对高效实现immutable stack以及queue进行一个简单的学习总结。由于已经有文章很好的介绍了实现思想，主要是利用链表的思想，这里就直接引用了，具体参考Immutable Stack. Let’s start with something simple: an">
<meta name="keywords" content="stack,queue">
<meta property="og:type" content="article">
<meta property="og:title" content="Immutable Stack and Queue">
<meta property="og:url" content="http://yoursite.com/2015/07/16/DSA_Immutable Stack/index.html">
<meta property="og:site_name" content="Plusaber&#39;s Blog">
<meta property="og:description" content="Immutable Stack 最近实验需要使用到immutable stack，直接复制创建新的栈时间和空间效率都十分低，这里对高效实现immutable stack以及queue进行一个简单的学习总结。由于已经有文章很好的介绍了实现思想，主要是利用链表的思想，这里就直接引用了，具体参考Immutable Stack. Let’s start with something simple: an">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2016-01-27T13:49:15.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Immutable Stack and Queue">
<meta name="twitter:description" content="Immutable Stack 最近实验需要使用到immutable stack，直接复制创建新的栈时间和空间效率都十分低，这里对高效实现immutable stack以及queue进行一个简单的学习总结。由于已经有文章很好的介绍了实现思想，主要是利用链表的思想，这里就直接引用了，具体参考Immutable Stack. Let’s start with something simple: an">





  
  
  <link rel="canonical" href="http://yoursite.com/2015/07/16/DSA_Immutable Stack/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Immutable Stack and Queue | Plusaber's Blog</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Plusaber's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/07/16/DSA_Immutable Stack/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Plusaber">
      <meta itemprop="description" content="Plusaber's Blog">
      <meta itemprop="image" content="/images/plusaber.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Plusaber's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Immutable Stack and Queue

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-07-16 00:00:00" itemprop="dateCreated datePublished" datetime="2015-07-16T00:00:00+09:00">2015-07-16</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DSA/" itemprop="url" rel="index"><span itemprop="name">DSA</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/07/16/DSA_Immutable Stack/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/07/16/DSA_Immutable Stack/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="immutable-stack"><a class="markdownIt-Anchor" href="#immutable-stack"></a> <a href="https://blogs.msdn.microsoft.com/ericlippert/2007/12/04/immutability-in-c-part-two-a-simple-immutable-stack/" target="_blank" rel="noopener">Immutable Stack</a></h1>
<p>最近实验需要使用到immutable stack，直接复制创建新的栈时间和空间效率都十分低，这里对高效实现immutable stack以及queue进行一个简单的学习总结。由于已经有文章很好的介绍了实现思想，主要是利用链表的思想，这里就直接引用了，具体参考<a href="https://blogs.msdn.microsoft.com/ericlippert/2007/12/04/immutability-in-c-part-two-a-simple-immutable-stack/" target="_blank" rel="noopener">Immutable Stack</a>.</p>
<p>Let’s start with something simple: an immutable stack.</p>
<p>Now, immediately I hear the objection: a stack is by its very nature something that changes. A stack is an abstract data type (ADT) with the interface</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Push</span><span class="params">(T t)</span></span>;</span><br><span class="line"><span class="function">T <span class="title">Pop</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">bool</span> IsEmpty &#123; get; &#125;</span><br></pre></td></tr></table></figure>
<p>You push stuff onto it, you pop stuff off of it, it changes. How can it be immutable?</p>
<p>Every time you need to make a data structure immutable, you use basically the same trick: an operation which “changes” the data structure does so by constructing a new data structure. The original data structure stays the same.</p>
<p>How can that possibly be efficient? Surely we’ll be allocating memory all over the place! Well, actually, in this case, no. An immutable stack is every bit as efficient as a mutable stack. Even better: in some cases, it can be considerably more efficient, as we’ll see.</p>
<p>Let’s start by defining an interface for our immutable structure. While we’re at it, we’ll fix a problem with the stack ADT above, namely that you cannot interrogate the stack without changing it. And we’ll make the stack enumerable just for the heck of it:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> interface IStack&lt;T&gt; : IEnumerable&lt;T&gt;</span><br><span class="line">&#123;</span><br><span class="line">    IStack&lt;T&gt; Push(T value);</span><br><span class="line">    IStack&lt;T&gt; Pop();</span><br><span class="line">    <span class="function">T <span class="title">Peek</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="keyword">bool</span> IsEmpty &#123; get; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Pushing and popping give you back an entirely new stack, and Peek lets you look at the top of the stack without popping it.</p>
<p>Now let’s think about constructing one of these things here.</p>
<p>Clearly if we have an existing stack we can construct a new one by pushing or popping it. But we have to start somewhere. Since every empty stack is the same, it seems sensible to have a singleton empty stack.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> sealed <span class="class"><span class="keyword">class</span> <span class="title">Stack</span>&lt;T&gt; :</span> IStack&lt;T&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> sealed <span class="class"><span class="keyword">class</span> <span class="title">EmptyStack</span> :</span> IStack&lt;T&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">bool</span> IsEmpty &#123; get &#123; <span class="keyword">return</span> <span class="literal">true</span>; &#125; &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> T <span class="title">Peek</span><span class="params">()</span> </span>&#123; <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"Empty stack"</span>); &#125;</span><br><span class="line">        <span class="keyword">public</span> IStack&lt;T&gt; Push(T value) &#123; <span class="keyword">return</span> <span class="keyword">new</span> Stack&lt;T&gt;(value, <span class="keyword">this</span>); &#125;</span><br><span class="line">        <span class="keyword">public</span> IStack&lt;T&gt; Pop() &#123; <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"Empty stack"</span>); &#125;</span><br><span class="line">        <span class="keyword">public</span> IEnumerator&lt;T&gt; GetEnumerator() &#123; yield <span class="keyword">break</span>; &#125;</span><br><span class="line">        IEnumerator IEnumerable.GetEnumerator() &#123; <span class="keyword">return</span> <span class="keyword">this</span>.GetEnumerator(&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> readonly EmptyStack empty = <span class="keyword">new</span> EmptyStack();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> IStack&lt;T&gt; Empty &#123; get &#123; <span class="keyword">return</span> empty; &#125; &#125;</span><br><span class="line">    <span class="keyword">private</span> readonly T head;</span><br><span class="line">    <span class="keyword">private</span> readonly IStack&lt;T&gt; tail;</span><br><span class="line">    <span class="keyword">private</span> Stack(T head, IStack&lt;T&gt; tail)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.head = head;</span><br><span class="line">        <span class="keyword">this</span>.tail = tail;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">bool</span> IsEmpty &#123; get &#123; <span class="keyword">return</span> <span class="literal">false</span>; &#125; &#125;</span><br><span class="line">    <span class="keyword">public</span> T Peek() &#123; <span class="keyword">return</span> head; &#125;</span><br><span class="line">    <span class="keyword">public</span> IStack&lt;T&gt; Pop() &#123; <span class="keyword">return</span> tail; &#125;</span><br><span class="line">    <span class="keyword">public</span> IStack&lt;T&gt; Push(T value) &#123; <span class="keyword">return</span> <span class="keyword">new</span> Stack&lt;T&gt;(value, <span class="keyword">this</span>); &#125;</span><br><span class="line">    <span class="keyword">public</span> IEnumerator&lt;T&gt; GetEnumerator()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(IStack&lt;T&gt; <span class="built_in">stack</span> = <span class="keyword">this</span>; !<span class="built_in">stack</span>.IsEmpty ; <span class="built_in">stack</span> = <span class="built_in">stack</span>.Pop())</span><br><span class="line">            yield <span class="keyword">return</span> <span class="built_in">stack</span>.Peek();</span><br><span class="line">    &#125;</span><br><span class="line">    IEnumerator IEnumerable.GetEnumerator() &#123;<span class="keyword">return</span> <span class="keyword">this</span>.GetEnumerator();&#125;</span><br></pre></td></tr></table></figure>
<p>And now we can easily create stacks and push stuff onto them. Notice how the fact that we have immutability means that stacks with the same tail can share state, saving on memory:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">IStack&lt;<span class="keyword">int</span>&gt; s1 = Stack&lt;<span class="keyword">int</span>&gt;.Empty;</span><br><span class="line">IStack&lt;<span class="keyword">int</span>&gt; s2 = s1.Push(<span class="number">10</span>);</span><br><span class="line">IStack&lt;<span class="keyword">int</span>&gt; s3 = s2.Push(<span class="number">20</span>);</span><br><span class="line">IStack&lt;<span class="keyword">int</span>&gt; s4 = s2.Push(<span class="number">30</span>); <span class="comment">// shares its tail with s3.</span></span><br></pre></td></tr></table></figure>
<h1 id="immutable-queue"><a class="markdownIt-Anchor" href="#immutable-queue"></a> Immutable Queue</h1>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.NoSuchElementException;</span><br><span class="line"><span class="keyword">import</span> java.util.Queue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersistentQueue</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">PersistentStack</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">		<span class="keyword">private</span> E head;</span><br><span class="line">		<span class="keyword">private</span> PersistentStack&lt;E&gt; tail;</span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">private</span> <span class="title">PersistentStack</span><span class="params">(E obj, PersistentStack&lt;E&gt; tail)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.head = obj;</span><br><span class="line">			<span class="keyword">this</span>.tail = tail;</span><br><span class="line">			<span class="keyword">this</span>.size = tail.size + <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> PersistentStack <span class="title">emptyStack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> PersistentStack();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">private</span> <span class="title">PersistentStack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.head = <span class="keyword">null</span>;</span><br><span class="line">			<span class="keyword">this</span>.tail = <span class="keyword">null</span>;</span><br><span class="line">			<span class="keyword">this</span>.size = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> PersistentStack&lt;E&gt; <span class="title">toReverseStack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			PersistentStack&lt;E&gt; stack = <span class="keyword">new</span> PersistentStack&lt;E&gt;();</span><br><span class="line">			PersistentStack&lt;E&gt; tail = <span class="keyword">this</span>;</span><br><span class="line">			<span class="keyword">while</span> (!tail.isEmpty()) &#123;</span><br><span class="line">				stack = stack.push(tail.head);</span><br><span class="line">				tail = tail.tail;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> stack;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">this</span>.size == <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> PersistentStack&lt;E&gt; <span class="title">push</span><span class="params">(E obj)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> PersistentStack&lt;E&gt;(obj, <span class="keyword">this</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> PersistentStack&lt;E&gt; order;</span><br><span class="line">	<span class="keyword">private</span> PersistentStack&lt;E&gt; reverse;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">PersistentQueue</span><span class="params">(PersistentStack&lt;E&gt; order, PersistentStack&lt;E&gt; reverse)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.order = order;</span><br><span class="line">		<span class="keyword">this</span>.reverse = reverse;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">PersistentQueue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.order = PersistentStack.emptyStack();</span><br><span class="line">		<span class="keyword">this</span>.reverse = PersistentStack.emptyStack();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> PersistentQueue&lt;E&gt; <span class="title">enqueue</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> == e)</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> PersistentQueue&lt;E&gt;(<span class="keyword">this</span>.order.push(e), <span class="keyword">this</span>.reverse);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> PersistentQueue&lt;E&gt; <span class="title">dequeue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.isEmpty())</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">		<span class="keyword">if</span> (!<span class="keyword">this</span>.reverse.isEmpty()) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> PersistentQueue&lt;E&gt;(<span class="keyword">this</span>.order, <span class="keyword">this</span>.reverse.tail);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">// revers the ordered stack then "clean" that stack</span></span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> PersistentQueue&lt;E&gt;(PersistentStack.emptyStack(),</span><br><span class="line">					<span class="keyword">this</span>.order.toReverseStack().tail);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">balanceQueue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.reverse = <span class="keyword">this</span>.order.toReverseStack();</span><br><span class="line">		<span class="keyword">this</span>.order = PersistentStack.emptyStack();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> E <span class="title">peek</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.isEmpty())</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.reverse.isEmpty())</span><br><span class="line">			balanceQueue();</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.reverse.head;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> size() == <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.order.size + <span class="keyword">this</span>.reverse.size;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="creating-a-simple-immutable-stack"><a class="markdownIt-Anchor" href="#creating-a-simple-immutable-stack"></a> Creating a simple immutable stack</h1>
<p><a href="http://blog.slaks.net/2013-06-11/readonly-vs-immutable/" target="_blank" rel="noopener">Last time</a>, I explained the basic meaning of immutability. The simplest useful example of an immutable class is an immutable stack. Immutable stacks work just like regular stacks – with Push(), Pop(), and Peek() methods – except that instead of mutating the original instance, Push() and Pop() return a new, modified, instance.</p>
<p>In code, that looks like:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> interface IStack&lt;T&gt; &#123;</span><br><span class="line">    IStack&lt;T&gt; Push(T element);</span><br><span class="line">    IStack&lt;T&gt; Pop();</span><br><span class="line">    <span class="function">T <span class="title">Peek</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="keyword">bool</span> IsEmpty &#123; get; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">IStack&lt;<span class="keyword">int</span>&gt; myStack = empty;</span><br><span class="line">myStack = myStack.Push(<span class="number">1</span>).Push(<span class="number">2</span>).Push(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (!myStack.IsEmpty) &#123;</span><br><span class="line">    Console.WriteLine(myStack.Peek());</span><br><span class="line">    myStack = myStack.Pop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Each implementation of this interface would supply a singleton empty instance; since they are immutable; there is no need to have more than one empty instance. Thus, there is no need for a constructor. Since Pop() needs to return the new stack, it cannot return the removed item; therefore, Peek() is the only way to get the item.</p>
<p>As a side benefit, this pattern naturally enables and encourages fluent interfaces, since each mutation methods returns a new instance. (eg, myStack.Push(1).Push(2).Push(3))</p>
<p>The naive implementation of this interface would use a list, and copy the list when creating a new stack:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NaiveStack</span>&lt;T&gt; :</span> IStack&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> readonly ReadOnlyCollection&lt;T&gt; items;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">NaiveStack</span><span class="params">(IList&lt;T&gt; items)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.items = <span class="keyword">new</span> ReadOnlyCollection&lt;T&gt;(items);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> readonly NaiveStack&lt;T&gt; Empty </span><br><span class="line">        = <span class="keyword">new</span> NaiveStack&lt;T&gt;(<span class="keyword">new</span> T[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> IStack&lt;T&gt; Push(T element) &#123;</span><br><span class="line">        var <span class="built_in">list</span> = <span class="keyword">new</span> List&lt;T&gt;(items);</span><br><span class="line">        <span class="built_in">list</span>.Add(element);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> NaiveStack&lt;T&gt;(<span class="built_in">list</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> IStack&lt;T&gt; Pop() &#123;</span><br><span class="line">        <span class="keyword">if</span> (IsEmpty)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="string">"Stack is empty"</span>);</span><br><span class="line">        var <span class="built_in">list</span> = <span class="keyword">new</span> List&lt;T&gt;(items);</span><br><span class="line">        <span class="built_in">list</span>.RemoveAt(<span class="built_in">list</span>.Count - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> NaiveStack&lt;T&gt;(<span class="built_in">list</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">Peek</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> items.Last(); &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">bool</span> IsEmpty &#123; </span><br><span class="line">        get &#123; <span class="keyword">return</span> items.Count == <span class="number">0</span>; &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The problem with this approach is that each mutation requires an O(n) copy to create the list behind the new instance. This makes Push() and Pop() awfully slow, and vastly increases the memory footprint until the intermediate instances can be GCd.</p>
<p>To solve these problems, we can design the stack as a persistent data structure. Instead of copying anything when pushing on to a stack, we cab make the new stack instance hold only the newly added item, and maintain a reference to the previous instance storing the rest of the items. Popping from the stack can then simply return the previous instance. Basically, the stack becomes an immutable single-linked list.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> abstract <span class="class"><span class="keyword">class</span> <span class="title">PersistentStack</span>&lt;T&gt; :</span> IStack&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> readonly PersistentStack&lt;T&gt; Empty = <span class="keyword">new</span> EmptyNode();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> IStack&lt;T&gt; Push(T element) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> LinkNode(<span class="keyword">this</span>, element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">EmptyNode</span> :</span> PersistentStack&lt;T&gt; &#123;</span><br><span class="line">        <span class="keyword">public</span> override IStack&lt;T&gt; Pop() &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="string">"Stack is empty"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> override T <span class="title">Peek</span><span class="params">()</span> </span>&#123; </span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="string">"Stack is empty"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> override <span class="keyword">bool</span> IsEmpty &#123; get &#123; <span class="keyword">return</span> <span class="literal">true</span>; &#125; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkNode</span> :</span> PersistentStack&lt;T&gt; &#123;</span><br><span class="line">        readonly IStack&lt;T&gt; previous;</span><br><span class="line">        readonly T element;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">LinkNode</span><span class="params">(IStack&lt;T&gt; previous, T element)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.previous = previous;</span><br><span class="line">            <span class="keyword">this</span>.element = element;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> override IStack&lt;T&gt; Pop() &#123;</span><br><span class="line">            <span class="keyword">return</span> previous;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> override T <span class="title">Peek</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> element; &#125;</span><br><span class="line">        <span class="keyword">public</span> override <span class="keyword">bool</span> IsEmpty &#123; get &#123; <span class="keyword">return</span> <span class="literal">false</span>; &#125; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> abstract IStack&lt;T&gt; Pop();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> abstract T <span class="title">Peek</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="keyword">public</span> abstract <span class="keyword">bool</span> IsEmpty &#123; get; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In this implementation, the empty and non-empty nodes are different enough that I decided to use polymorphism rather than if statements. The PersistentStack<t> type contains the only common logic (Push()); everything else is implement by the two concrete classes.</t></p>
<p>Here, the empty stack truly is a singleton; only one instance will ever be created for each element type. It can only be used as a starting point to create new stacks; the other methods simply throw exceptions. It also serves as the final node in the chain for all non-empty stacks.</p>
<p>Pushing onto any stack (empty or not) returns a new node that holds the new item and points to the previous stack; popping a non-empty stack simply returns that reference.</p>
<p>Like other linked lists, this approach implements both Push() and Pop() in O(1) in both memory and time.</p>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/stack/" rel="tag"># stack</a>
          
            <a href="/tags/queue/" rel="tag"># queue</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/07/02/Java_Spring(2)/" rel="next" title="Spring(2)_依赖注入">
                <i class="fa fa-chevron-left"></i> Spring(2)_依赖注入
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/07/23/Java_Spring(3)/" rel="prev" title="Spring(3)_事件处理">
                Spring(3)_事件处理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/plusaber.jpg" alt="Plusaber">
            
              <p class="site-author-name" itemprop="name">Plusaber</p>
              <div class="site-description motion-element" itemprop="description">Plusaber's Blog</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">82</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">12</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">22</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://jp.linkedin.com/in/zebangchen" title="https://jp.linkedin.com/in/zebangchen" rel="noopener" target="_blank">LinkedIn</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://indeed.com" title="https://indeed.com" rel="noopener" target="_blank">Indeed</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://baito.indeed.com" title="https://baito.indeed.com" rel="noopener" target="_blank">Baito</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.kaggle.com" title="https://www.kaggle.com" rel="noopener" target="_blank">Kaggle</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#immutable-stack"><span class="nav-number">1.</span> <span class="nav-text"> Immutable Stack</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#immutable-queue"><span class="nav-number">2.</span> <span class="nav-text"> Immutable Queue</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#creating-a-simple-immutable-stack"><span class="nav-number">3.</span> <span class="nav-text"> Creating a simple immutable stack</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2014 – <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Plusaber</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.1.1</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.1"></script>

  <script src="/js/motion.js?v=7.1.1"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.1.1"></script>




  
  <script src="/js/scrollspy.js?v=7.1.1"></script>
<script src="/js/post-details.js?v=7.1.1"></script>



  


  <script src="/js/next-boot.js?v=7.1.1"></script>


  

  

  

  
  
  <script id="dsq-count-scr" src="https://plusaber.disqus.com/count.js" async></script>


<script>
  var disqus_config = function() {
    this.page.url = "http://yoursite.com/2015/07/16/DSA_Immutable Stack/";
    this.page.identifier = "2015/07/16/DSA_Immutable Stack/";
    this.page.title = 'Immutable Stack and Queue';
    };
  function loadComments() {
    var d = document, s = d.createElement('script');
    s.src = 'https://plusaber.disqus.com/embed.js';
    s.setAttribute('data-timestamp', '' + +new Date());
    (d.head || d.body).appendChild(s);
  }
  
    loadComments();
  
</script>





  


  




  

  

  
  

  
  

  


  

  

  

  

  

  

  

  

  
<script>
  $('.highlight').not('.gist .highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('Copy').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('Copy');
      }, 300);
    }).append(e);
  })
</script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->


  

  

</body>
</html>
