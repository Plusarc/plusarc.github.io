<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="google88d81a02a91db82f" />










  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2" />






<meta name="description" content="Plusaber&apos;s Blog">
<meta property="og:type" content="website">
<meta property="og:title" content="Plusaber's Blog">
<meta property="og:url" content="http://yoursite.com/page/6/index.html">
<meta property="og:site_name" content="Plusaber's Blog">
<meta property="og:description" content="Plusaber&apos;s Blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Plusaber's Blog">
<meta name="twitter:description" content="Plusaber&apos;s Blog">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"right","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/page/6/"/>


  <title> Plusaber's Blog </title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="zh-hk">

  


<!-- hexo-inject:begin --><!-- hexo-inject:end --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-79158075-1', 'auto');
  ga('send', 'pageview');
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-right 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Plusaber's Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首頁
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分類
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            歸檔
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            標籤
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/19/System Design_大型网站安全架构/" itemprop="url">
                  System Design_大型网站安全架构
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">發表於</span>
            <time itemprop="dateCreated" datetime="2015-11-19T00:00:00+09:00" content="2015-11-19">
              2015-11-19
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/System-design/" itemprop="url" rel="index">
                    <span itemprop="name">System design</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/11/19/System Design_大型网站安全架构/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/11/19/System Design_大型网站安全架构/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="网站应用攻击与防御"><a href="#网站应用攻击与防御" class="headerlink" title="网站应用攻击与防御"></a>网站应用攻击与防御</h1><h2 id="XSS攻击"><a href="#XSS攻击" class="headerlink" title="XSS攻击"></a>XSS攻击</h2><p>XSS攻击即夸站点脚本攻击(Cross Site Script)，指黑客通过篡改网页，注入恶意HTML脚本，在用户浏览网页时，控制用户浏览器进行恶意操作的一种攻击方式。</p>
<p>常见的XSS攻击类型有两种，一种是反射型，攻击者诱使用户点击一个嵌入恶意脚本的链接，达到攻击的目的。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c8_1.png" alt="System_design_c8_1"></p>
<p>另一种XSS攻击是持久型XSS攻击，黑客提交含有恶意脚本的请求，保存在被攻击的Web站点的数据库中，用户浏览网页时，恶意脚本被包含在正常页面中，达到攻击的目的。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c8_2.png" alt="System_design_c8_2"></p>
<p>XSS防攻击的主要方式有如下两种：</p>
<p><strong>消毒</strong></p>
<p>XSS攻击者一般都是通过在请求中嵌入恶意脚本达到攻击目的，这些脚本是一般用户输入中不使用的，如果进行过滤和消毒处理，即对某些html危险字符转义，如”&gt;”转义为”&amp;gt”等，就可以防止大部分攻击。为了避免对不必要的内容转移错误，如”3&lt;5”中的”&lt;”需要进行文本匹配后再转义，如”&lt;img src=”这样的上下文中的”&lt;”才转义。消毒几乎是所有网站最必备的XSS防攻击手段。</p>
<p><strong>HttpOnly</strong></p>
<p>浏览器禁止页面JavaScript访问带有HttpOnly属性的Cookie。HttpOnly并不是直接对抗XSS攻击的，而是防止XSS攻击窃取Cookie。对于存放敏感信息的Cookie，如用户认证信息等，可通过对该Cookie添加HttpOnly属性，避免被攻击脚本窃取。</p>
<h2 id="注入攻击"><a href="#注入攻击" class="headerlink" title="注入攻击"></a>注入攻击</h2><p>注入攻击主要有两种形式，SQL注入攻击和OS注入攻击。SQL注入攻击为攻击者在HTTP请求中注入恶意SQL命令(drop table users)，服务器用请求构造参数构造数据库SQL命令时，恶意SQL被一起构造，并在数据库执行。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c8_3.png" alt="System_design_c8_3"></p>
<p>SQL注入攻击需要攻击者对数据库结构有所了解才能进行，攻击者获取数据库表结构信息的手段有如下几种：</p>
<p><strong>网站基于开源软件搭建</strong><br><strong>错误回显</strong>：如果网站开启错误回显，即服务器内部500错误会显示到浏览器上。<br><strong>盲注</strong>：网站关闭错误回显，攻击者根据页面变化情况判断SQL语句的执行情况，据此猜测数据库表结构，难度比较大。</p>
<p>防御SQL注入攻击首先要避免被攻击者猜测到表名等数据库表结构信息，此外还可以采用如下方式：</p>
<p><strong>消毒</strong>：和防XSS攻击一样，请求参数消毒是一种比较简单粗暴又有效的手段。通过正则匹配，过滤请求数据中可能注入的SQL，如”drop table”等。</p>
<p><strong>参数绑定</strong>：使用预编译手段，绑定参数是最好的防SQL注入方法。目前许多数据访问层框架，如IBatis，Hibernate等，都实现SQL预编译和参数绑定，攻击者的恶意SQL会被当做SQL的参数，而不是SQL命令被执行。</p>
<p>除了SQL注入，攻击者还根据具体应用，注入OS命令、编程语言代码等，利用程序漏洞，达到攻击目的。</p>
<h2 id="CSRF攻击"><a href="#CSRF攻击" class="headerlink" title="CSRF攻击"></a>CSRF攻击</h2><p>CSRF(Cross Site Request Forgery，跨站点请求伪造)，攻击者通过跨站请求，以合法用户的身份进行非法操作，如转账交易等。CSRF的主要手法是利用跨站请求，在用户不知情的情况下，以用户的身份伪造请求。其核心是利用了浏览器Cookie或服务器Session策略，盗取用户身份。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c8_4.png" alt="System_design_c8_4"></p>
<p>CSRF的防御手段主要是识别请求者身份。主要有下面几种方法：</p>
<p><strong>表单Token</strong></p>
<p>CSRF是一个伪造用户请求的操作，所以需要构造用户的请求的所有参数才可以。表单Token通过在请求参数中增加随机数的方法来阻止攻击获得所有请求参数：在页面表单中增加一个随机数作为Token，每次响应页面的Token都不相同，从正常页面提交的请求会包含该Token值，而伪造的请求无法获得该值，服务器检查请求参数中Token的值是否存在并且正确以确定请求提交者是否为伪造的。</p>
<p><strong>验证码</strong></p>
<p>验证码是一种更加简单有效的手段，即请求提交时，需要通过用户输入验证码。</p>
<p><strong>Referer check</strong></p>
<p>HTTP请求头的Referer域中记录着请求来源，可通过检查请求来源，验证其是否合法。</p>
<h2 id="其他攻击和漏洞"><a href="#其他攻击和漏洞" class="headerlink" title="其他攻击和漏洞"></a>其他攻击和漏洞</h2><p><strong>Error Code</strong><br>错误回显信息。可以通过配置Web服务器参数，跳转到500页面(HTTP响应码500表示服务器内部错误)到专门的错误页面即可，Web应用常用的MVC框架也有这个功能。</p>
<p><strong>HTML注释</strong>：HTML注释会显示在客户端浏览器。</p>
<p><strong>文件上传</strong>上传可执行程序以及攻击者获得服务器端命令执行能力。有效的手段是设置上传文件白名单，只允许上传可靠的文件类型。此外还可以修改文件名，使用专门的存储等手段。</p>
<p><strong>路径遍历</strong>：攻击者在请求的URL中使用相对路径，遍历系统为开放的目录和文件。防御主要是将JS,CSS等资源文件部署在独立服务器，使用独立域名，其他文件不使用静态URL访问，动态参数最好不包含文件路径信息。</p>
<h2 id="Web应用防火墙"><a href="#Web应用防火墙" class="headerlink" title="Web应用防火墙"></a>Web应用防火墙</h2><p>ModSecurity是一个开源的Web应用防火墙，自动探测攻击并保护Web程序，能够同一拦截请求，过滤恶意参数，自动消毒，添加Token等。既可以嵌入到Web应用服务器中，也可以作为一个独立的应用程序启动。</p>
<p>ModSecurity采用处理逻辑与攻击规则集合分离的架构模式。处理逻辑（执行引擎）负责请求和响应的拦截过滤，规则加载执行等功能。而攻击规则集合则负责描述对具体攻击的规则定义、模式识别、防御策略等功能（可以通过文本方式进行描述）。处理逻辑比较稳定，规则集合需要不断针对漏洞进行升级，这时一种可扩展的架构设计。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c8_5.png" alt="System_design_c8_5"></p>
<h2 id="网站安全漏洞扫描"><a href="#网站安全漏洞扫描" class="headerlink" title="网站安全漏洞扫描"></a>网站安全漏洞扫描</h2><p>网络安全漏洞扫描工具是根据内置规则，构造具有攻击性的URL请求，模拟黑客攻击行为，用以发现网站安全漏洞的工具。</p>
<h1 id="信息加密技术及密钥安全管理"><a href="#信息加密技术及密钥安全管理" class="headerlink" title="信息加密技术及密钥安全管理"></a>信息加密技术及密钥安全管理</h1><p>网站用户账户密码等敏感信息不能以明文存储，必须要进行加密处理。信息加密技术可分为三类：单项散列加密，对称加密和非对称加密。</p>
<h2 id="单向散列加密"><a href="#单向散列加密" class="headerlink" title="单向散列加密"></a>单向散列加密</h2><p>单向散列加密是指通过对不同输入长度的信息进行散列计算，得到固定长度的输出，这个散列计算过程是单向的，即不能对固定长度的输出进行逆计算得到输入信息。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c8_6.png" alt="System_design_c8_6"></p>
<p>利用单向散列加密的特性，可以进行密码加密保存，即用户注册时的密码不直接保存到数据库，而是进行单向散列加密后将密文存入数据库。用户登录时，进行密码验证，同样计算得到输入密码的密文，并和数据库的密文比较。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c8_7.png" alt="System_design_c8_7"></p>
<p>这样即使数据库被”拖库”，也不会泄露用户的密码信息。</p>
<p>虽然不能通过算法将单向散列密文反算得到明文，但是由于人们设置密码具有一定模式，因此通过彩虹表(人们常用密码和对应的密文关系表等)等手段可以进行猜测式破解。</p>
<p>为了加强单向散列计算的安全性，还会给散列算法加点盐（salt），salt相当于加密的密钥，增加了破解的难度。</p>
<p>常用的单向散列算法有MD5,SHA等。单向散列算法还有一个特点就是输入的任何微小变化都会导致输出的完全不同，这个特性有时也会被用来生成信息摘要、计算具有高离散程度的随机数等用途。</p>
<h2 id="对称加密"><a href="#对称加密" class="headerlink" title="对称加密"></a>对称加密</h2><p>所谓对称加密是指加密和解密使用的密钥是同一个密钥（或者可以互相推算）。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c8_8.png" alt="System_design_c8_8"></p>
<p>对称加密通常用在信息需要安全交换或存储的场合，如Cookie加密、通信加密等。</p>
<p>对称加密的优点是算法简单，加密解密效率高，适合对大量数据加密。缺点是加密解密使用同一个密钥，远程通信的情况下如何安全的交换密钥是个难题，如果密钥丢失，那么所有的加密信息也就失去安全性。</p>
<p>常用的对称加密算法有DES，RC算法等。对称加密是一种传统加密手段，也是最常用的加密手段，适用于绝大多数需要加密的场合。</p>
<h2 id="非对称加密"><a href="#非对称加密" class="headerlink" title="非对称加密"></a>非对称加密</h2><p>不同于对称加密，非对称加密和解密使用的密钥不是同一密钥，其中一个对外公开，被称为公钥，另一个只有所有者直到，称为私钥。使用公钥加密的信息必须要私钥才能解开，反之，用私钥加密的信息只有用公钥才能解开。理论上不可能通过公钥计算获得私钥。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c8_9.png" alt="System_design_c8_9"></p>
<p>非对称加密技术通常用在信息安全传输、数字签名等场合。</p>
<p>信息发送者A通过公开渠道获得信息接收者B的公钥，对提交信息进行加密，然后发送到B，B得到密文信息后使用私钥解密获得明文信息。即使信息在中途被窃取，没有B的私钥也无法还原明文。</p>
<p>数字签名的过程则相反，签名者用自己的私钥对信息加密，然后发送给对方，接收方用签名者的公钥对信息进行解密，获得明文信息。由于私钥只有签名者拥有，因此该信息必然是由签名者发送的，不可抵赖，具有签名性质。</p>
<p>在实际应用中，常常会混合使用对称加密和非对称加密。先使用非对称加密技术对对称密钥进行传输，然后使用对称加密技术进行信息加密解密与交换。另外可以对同一个数据两次使用非对称加密，可同时实现信息的安全传输和数字签名的目的。</p>
<p>非对称加密的常用算法有RSA算法等。HTTPS传输中浏览器使用的数字证书实质上是经过权威机构认证的非对称加密的公钥。</p>
<h2 id="密钥安全管理"><a href="#密钥安全管理" class="headerlink" title="密钥安全管理"></a>密钥安全管理</h2><p>上面的加密算法能否达到安全保密关键的一点是密钥的安全。信息的安全是靠密钥保证的。</p>
<p>改善密钥安全性的手段有两种：</p>
<p>一种是包密钥和算法放在一个独立的服务器上，甚至做出一个专用的硬件设施，对胃提供加密和解密服务，应用系统通过调用这个服务，实现数据的加密解密。优点是安全性高，但是成本较高，系统开销大，甚至可能称为应用瓶颈。</p>
<p>另一种方案是将加密解密算法放在应用系统中，密钥则放在独立服务器中，为了提高密钥的安全性，实际存储时，密钥被切分为数片，加密后分别保存在不同的存储介质中，兼顾密钥安全性有改善了性能。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c8_10.png" alt="System_design_c8_10"></p>
<p>应用程序调用密钥安全管理系统提供的加密解密服务接口对信息进行加密解密，该接口实现了常用的加密解密算法并根据需求任意扩展。加密解密服务接口则通过密钥服务器的密钥服务取得加密解密密钥，并缓存在本地（定时更新）。而密钥服务器中的密钥则来自多个密钥存储服务器，一个密钥分片后存储在多个服务器中，每个服务器都有专人负责管理。密钥申请者、管理者、安全审核人员通过密钥管理控制台管理更新密钥，没有人能够查看完整的密钥信息。</p>
<h1 id="信息过滤与反垃圾"><a href="#信息过滤与反垃圾" class="headerlink" title="信息过滤与反垃圾"></a>信息过滤与反垃圾</h1><p>常用的信息过滤与反垃圾手段有以下几种。</p>
<h2 id="文本匹配"><a href="#文本匹配" class="headerlink" title="文本匹配"></a>文本匹配</h2><p>文本匹配主要解决敏感词过滤的问题，进行消毒处理或者拒绝发表。</p>
<p>如果敏感词较少，可以直接使用正则表达式匹配，但是效率较差，不使用高并发量时以及大数据量时。更好的选择是基于Trie树，或则Trie树的变种，如双数组Trie算法，利用两个稀疏数组存储树结构，base数组存储Trie树的节点，check数组进行状态检查。</p>
<p>另一种更简单的实现是通过构造多级Hash表进行文本匹配。过滤树的分支可能比较多，为了提高匹配速度，减少不必要的查找，同一层中相同父节点的字可放在Hash表中。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c8_11.png" alt="System_design_c8_11"></p>
<p>有时还需要对信息进行降噪预处理，如”笨_%单”。</p>
<h2 id="分类算法"><a href="#分类算法" class="headerlink" title="分类算法"></a>分类算法</h2><p>用于自动识别广告信息、垃圾邮件等。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c8_12.png" alt="System_design_c8_12"></p>
<p>比较简单实用的有贝叶斯分类算法，贝叶斯算法认为特征值之间是独立的，所以也成为朴素贝叶斯算法，然而这个假设很多时候是不成立的，特征值之间具有关联性。通过对贝叶斯算法增加特征值的关联依赖处理，得到TAN算法。更进一步，通过对关联规则的聚类挖掘，可以到ARCS(Association Rule Clustering System)等更强大的算法。由于朴素贝叶斯的简单高效，所以其仍然是很多在线系统的首选。</p>
<p>分类算法除了用于反垃圾，也用于信息自动分类等。</p>
<h2 id="黑名单"><a href="#黑名单" class="headerlink" title="黑名单"></a>黑名单</h2><p>黑名单可以通过Hash表实现，简单高效，但是内存消耗较大。在黑名单列表非常大时，如果能够容忍小概率的差错，可以使用布隆过滤器代替Hash表(Bloom filter)。Bloom filter是一种常用的处理海量数据的技术。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c8_13.png" alt="System_design_c8_13"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/11/System Design_大型网站架构模式及核心要素/" itemprop="url">
                  System Design_大型网站架构模式及核心要素
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">發表於</span>
            <time itemprop="dateCreated" datetime="2015-11-11T00:00:00+09:00" content="2015-11-11">
              2015-11-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/System-design/" itemprop="url" rel="index">
                    <span itemprop="name">System design</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/11/11/System Design_大型网站架构模式及核心要素/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/11/11/System Design_大型网站架构模式及核心要素/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="大型网站架构模式"><a href="#大型网站架构模式" class="headerlink" title="大型网站架构模式"></a>大型网站架构模式</h1><p>所谓模式就是描述了在我们周围不断重复发生的问题以及该问题解决方案的核心，这样我们可以一次又一次使用该方案而不必重复解决问题。模式的关键在于模式的可重复性，问题与场景的可重复性带来解决方案的可重复使用。</p>
<p>为了解决大型网站面临的高并发访问、海量数据处理、高可靠运行等一系列问题与挑战，许多公司在实践中提出了许多解决方案，以实现网站高性能、高可用、易伸缩、可扩展、安全等技术架构目标。</p>
<h2 id="分层"><a href="#分层" class="headerlink" title="分层"></a>分层</h2><p>分层是企业应用系统常用的架构模式，将系统在横向维度切分为几个部分（垂直的分为几层），然后通过上层对下层的依赖和调用组成一个完整的系统，如分割为应用层、服务层、数据层，应用层可细分问u视图层、业务逻辑层。服务层可以细分为数据接口层、逻辑处理层。</p>
<p>不同层可以部署在不同的服务器上，实现低耦合，可伸缩。</p>
<h2 id="分割"><a href="#分割" class="headerlink" title="分割"></a>分割</h2><p>水平分割，例如按照功能将系统分割，包装为高内聚低耦合的模块单元，一方面有助于软件的开发和维护，同样便于不同模块的分布式部署，提高网站的并发处理能力和功能扩张能力。</p>
<h2 id="分布式"><a href="#分布式" class="headerlink" title="分布式"></a>分布式</h2><p>对于大型网站，分层和分割的一个主要目的是为了切分后的模块便于分布式部署，可通过增加机器提高并发能力。但分布式需要通过网络，会带来性能的影响，多个服务器也意味着机器出现问题的概率变大，降低网站的可用性。另外一个问题是在分布式的环境中保持数据一致性。</p>
<p>几种分布式方案：</p>
<ol>
<li>分布式应用和服务：将分层和分割后的应用和服务分布式部署，</li>
<li>分布式静态资源：将网站的静态资源独立分布式部署。</li>
<li>分布式数据和存储：分布式数据库，NoSQL等。</li>
<li>分布式计算</li>
</ol>
<h2 id="集群"><a href="#集群" class="headerlink" title="集群"></a>集群</h2><p>使用分布式虽然已经将分层和分割后的模块独立部署，但是对于用户访问集中的模块，还需要将独立部署的服务器集群化，即多台服务器部署相同服务，通过负载均衡设备共同对外提供服务。通过添加新服务器可以提高服务能力，也就是具有可伸缩性，另外还可以通过失效转移等机制保证可用性。</p>
<h2 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h2><ul>
<li><strong>CDN</strong>：内容分发网络，部署在离终端用户最近的网络服务提供商，缓存网站一些静态资源(变化较少的资源)或者热点内容。</li>
<li><strong>反向代理</strong>：反向代理属于网站前端架构的一部分，部署在网站的前端，当用户请求到达网站的数据中心时，最先访问的就是反向代理服务器，这里缓存网站的静态和热点资源，无需将请求转发给应用服务器就可以返回给用户。</li>
<li><strong>本地缓存</strong>：在应用服务器本地缓存热点数据，减少访问文件和数据库。</li>
<li><strong>分布式缓存</strong>：本地缓存一般不够大，另外将数据缓存在一个专门的分布式缓存集群中，通过网络通信访问缓存数据。</li>
</ul>
<h2 id="异步"><a href="#异步" class="headerlink" title="异步"></a>异步</h2><p>降低软件耦合性，前面分层、分割、分布也是同样的目标。通过异步，业务之间的消息传递不是同步调用，而是将一个业务操作分成多个阶段，每个阶段之间通过共享数据的方式异步执行协作。</p>
<p>在单一服务器内部可通过多线程共享内存队列的方式实现异步：在分布式系统中，多个服务器可以通过分布式消息队列实现异步。</p>
<p>异步架构是典型的生产者消费者模式，两者不存在直接调用，只要保持数据结构不变，批次功能实现可以随意变化而不互相影响，这对网站扩展新功能非常便利。另外，使用异步消息队列还有如下特性。</p>
<p><strong>提高系统可用性</strong>：消费者服务器发生故障，数据会在消息队列服务器中堆积，生产者可以继续处理业务请求，系统整体无故障。消费者服务器恢复正常后，继续处理消息队列中的数据。</p>
<p><strong>加快网站相应速度</strong>：处在业务处理前端的生产者服务器可以在处理完业务请求后，将数据写入消息队列后返回，不需要同步等待消费者服务器处理就可以返回，减少相应延迟。</p>
<p><strong>消除并发访问高峰</strong>：用户访问存在突然的高峰，如果同时同步处理所有访问，会导致网站负载过重，响应延迟。使用消息队列将突然增加的访问请求数据放入消息队列中，等待消费者服务器依次处理，就不会对整个网站负载造成太大压力。</p>
<h2 id="冗余"><a href="#冗余" class="headerlink" title="冗余"></a>冗余</h2><p>要保证网站的可用性，需要一定程度的服务器冗余运行，数据冗余备份，这样当某台服务器宕机时，可以将其上的服务和数据访问转移到其他机器上。数据库除了冷备份外，为了保证在线业务高可用，也需要对数据库进行主从分离，实时同步实现热备份。</p>
<h2 id="自动化"><a href="#自动化" class="headerlink" title="自动化"></a>自动化</h2><h2 id="安全"><a href="#安全" class="headerlink" title="安全"></a>安全</h2><h1 id="大型网站核心要素"><a href="#大型网站核心要素" class="headerlink" title="大型网站核心要素"></a>大型网站核心要素</h1><p>除了系统的功能需求外，软件架构还需要关注可能、可用性、伸缩性、扩展性、安全性这个5个架构要素，以及平衡这5个要素之间的关系以实现需求和架构目标。</p>
<h2 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h2><p>性能是网站的一个重要指标，用户无法忍受一个相应缓慢的网站。</p>
<p>性能的问题无处不在，所以优化的方面也很多：</p>
<ul>
<li>在浏览器端，可以通过浏览器缓存、页面压缩、减少cookie传输、JavaScript实现可以在本地实现的功能，减少访问次数</li>
<li>CDN，反向代理服务器缓存热点文件。</li>
<li>应用服务器端，可以使用服务器本地缓存和分布式缓存，通过缓存在内存的热点数据，减少访问数据库，加快请求处理过程。</li>
<li>异步将用户请求发送到消息队列等待处理，直接返回相应给用户。</li>
<li>在高并发请求的情况下，可以将多台应用服务器组成一个集群共同对外服务，提高整体处理能力。</li>
<li>代码层面，使用合适的数据结构、高效算法，以及多线程、改善内存管理等手段优化性能。</li>
<li>数据库服务器端，索引、索引、sql优化。</li>
<li>NoSQL，Hadoop，分布式计算和存储。</li>
</ul>
<p>衡量网站性能有一系列指标，如相应时间、TPS等，可以测试这些指标确定系统是否达到目标。</p>
<h2 id="可用性"><a href="#可用性" class="headerlink" title="可用性"></a>可用性</h2><p>高可用架构设计的前提是必然出现服务器宕机，设计目标是服务器宕机时，服务依然可用。</p>
<p>实现高可用的主要手段是冗余，应用部署在多台服务器上同时提供服务，数据存储在多台服务器上相互备份，任何一台机器宕机不会影响整体服务，也不会导致数据丢失。</p>
<p>对于应用服务器，可以通过负载均衡服务器组成一个集群共同对外提供服务，一台机器宕机时可以将服务转移到其他机器上，前提是服务器不在本地保存服务的会话信息。</p>
<p>对于存储服务器，需要实现实时备份。</p>
<h2 id="伸缩性"><a href="#伸缩性" class="headerlink" title="伸缩性"></a>伸缩性</h2><p>所谓伸缩性是指能否通过不断增加机器来缓解上升用户的并发访问压力和不断增长的数据存储需求。加入新的服务器后是否可以能提供和原来的服务器无差别的服务，集群中可容纳的总得服务器数量是否有限制。</p>
<p>对于应用服务器集群，只要服务器上不保存数据，所有服务器都是对等的，通过使用合适的负载均衡就可以向集群中不断加入服务器。</p>
<p>对于缓存服务器集群，加入新的服务其可能会导致缓存路由失效，进而导致集群中大部分缓存数据都无法访问。如果应用严重依赖缓存，可能对网站造成严重影响甚至数据库服务崩溃。需要改进缓存路由算法保证缓存数据的可访问性，一个解决方法是一致性hash算法。</p>
<p>关系数据库虽然支持数据复制，主从热备等机制，但是很难做到大规模集群的可伸缩性，因此关系数据库的集群伸缩方案必须在数据库之外实现，通过路由分区等手段将部署多个数据的服务器组成一个集群。</p>
<p>至于大部分NoSQL数据库产品，由于其就是为海量数据而生，所以对伸缩性支持都非常好，可以做到在较少操作下实现集群规模的线性伸缩。</p>
<h2 id="扩展性"><a href="#扩展性" class="headerlink" title="扩展性"></a>扩展性</h2><p>网站的扩展性架构直接关注网站的功能需求。网站快速发展，功能不断扩展，如何设计网站的架构使其能够快速相应需求变化，是网站可扩展的主要目的。</p>
<p>衡量网站架构扩展性的好坏的主要标准就是在网站增加新的业务产品时，是否可以实现对现有产品透明无影响，不需要改动或很少改动既有业务功能就可以上线新功能。不同产品之间是否很少耦合，一个产品改动对其他产品无影响。</p>
<p>网站可伸缩架构的主要手段是事件驱动和分布式服务。</p>
<p>事件驱动架构在网站使用消息队列实现，将用户请求和其他业务时间构造消息发布到消息队列，消息的处理作为消费者从消息队列中获取消息进行处理。通过这种方式将消息产生和消息处理分离开来，可以透明地增加新的消息生产者任务或者新的消息消费者任务。</p>
<p>分布式服务则是将业务和可复用的服务分离开来，通过分布式服务框架调用。新增产品可以调用可复用的服务实现自身的业务逻辑，而对现有产品没有任何影响。可复用服务升级变更时，也可以通过提供多版本服务对应用实现透明升级，不需要强制应用同步变更。</p>
<h2 id="安全性"><a href="#安全性" class="headerlink" title="安全性"></a>安全性</h2><p>安全架构目的是保证网站不受恶意访问和攻击，保护网站的重要数据不被窃取。</p>
<p>衡量网站安全架构的标准就是针对现存和潜在的各种攻击和窃密手段，是否有可靠的应对策略。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/08/Leetcode_Meeting Rooms/" itemprop="url">
                  Meeting Rooms
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">發表於</span>
            <time itemprop="dateCreated" datetime="2015-11-08T00:00:00+09:00" content="2015-11-08">
              2015-11-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/11/08/Leetcode_Meeting Rooms/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/11/08/Leetcode_Meeting Rooms/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Meeting-Rooms"><a href="#Meeting-Rooms" class="headerlink" title="Meeting Rooms"></a><a href="">Meeting Rooms</a></h1><p>Lock题目，参考：<br><a href="http://segmentfault.com/a/1190000003894670" target="_blank" rel="external">[Leetcode] Meeting Rooms 会议室.</a><br><a href="https://tonycao.gitbooks.io/leetcode-locked/content/LeetCode%20Locked/c1.6.html" target="_blank" rel="external">Leetcode_locked</a></p>
<h2 id="Meeting-Rooms-I"><a href="#Meeting-Rooms-I" class="headerlink" title="Meeting Rooms I"></a>Meeting Rooms I</h2><blockquote>
<p>Given an array of meeting time intervals consisting of start and end times <code>[[s1,e1],[s2,e2],...] (si &lt; ei)</code>, determine if a person could attend all meetings.</p>
<p>For example, Given <code>[[0, 30],[5, 10],[15, 20]]</code>, return false.</p>
</blockquote>
<h3 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h3><p>这题和Merge Intervals很像，我们按开始时间把这些Interval都给排序后，就挨个检查是否有冲突就行了。有冲突的定义是开始时间小于之前最晚的结束时间。这里之前最晚的结束时间不一定是上一个的结束时间，所以我们更新的时候要取最大值。</p>
<h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">canAttendMeetings</span><span class="params">(Interval[] intervals)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(intervals == <span class="keyword">null</span> || intervals.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        Arrays.sort(intervals, <span class="keyword">new</span> Comparator&lt;Interval&gt;()&#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Interval i1, Interval i2)</span></span>&#123;</div><div class="line">                <span class="keyword">return</span> i1.start - i2.start;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">int</span> end = intervals[<span class="number">0</span>].end;</div><div class="line">        <span class="comment">// 检查每一个Interval</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; intervals.length; i++)&#123;</div><div class="line">            <span class="comment">// 如果Interval的开始时间小于之前最晚的结束时间，就返回假</span></div><div class="line">            <span class="keyword">if</span>(intervals[i].start &lt; end) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            end = Math.max(end, intervals[i].end);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Meeting-Rooms-II"><a href="#Meeting-Rooms-II" class="headerlink" title="Meeting Rooms II"></a>Meeting Rooms II</h2><blockquote>
<p>Given an array of meeting time intervals consisting of start and end times <code>[[s1,e1],[s2,e2],...] (si &lt; ei)</code>, find the minimum number of conference rooms required.</p>
<p>For example, Given <code>[[0, 30],[5, 10],[15, 20]]</code>, return <code>2</code>.</p>
</blockquote>
<h3 id="Method-1"><a href="#Method-1" class="headerlink" title="Method"></a>Method</h3><p>这题的思路和<a href="http://www.geeksforgeeks.org/rearrange-a-string-so-that-all-same-characters-become-at-least-d-distance-away/" target="_blank" rel="external">Rearrange array to certain distance</a>很像，我们要用贪心法，即从第一个时间段开始，选择下一个最近不冲突的时间段，再选择下一个最近不冲突的时间段，直到没有更多。然后如果有剩余时间段，开始为第二个房间安排，选择最早的时间段，再选择下一个最近不冲突的时间段，直到没有更多，如果还有剩余时间段，则开辟第三个房间，以此类推。这里的技巧是我们不一定要遍历这么多遍，我们实际上可以一次遍历的时候就记录下，比如第一个时间段我们放入房间1，然后第二个时间段，如果和房间1的结束时间不冲突，就放入房间1，否则开辟一个房间2。然后第三个时间段，如果和房间1或者房间2的结束时间不冲突，就放入房间1或者2，否则开辟一个房间3，依次类推，最后统计开辟了多少房间。对于每个房间，我们只要记录其结束时间就行了，这里我们查找不冲突房间时，只要找结束时间最早的那个房间。<br>这里还有一个技巧，如果我们把这些房间当作List来管理，每次查询需要O(N)时间，如果我们用堆来管理，可以用logN时间找到时间最早结束的房间。</p>
<h3 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minMeetingRooms</span><span class="params">(Interval[] intervals)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(intervals == <span class="keyword">null</span> || intervals.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        Arrays.sort(intervals, <span class="keyword">new</span> Comparator&lt;Interval&gt;()&#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Interval i1, Interval i2)</span></span>&#123;</div><div class="line">                <span class="keyword">return</span> i1.start - i2.start;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        <span class="comment">// 用堆来管理房间的结束时间</span></div><div class="line">        PriorityQueue&lt;Integer&gt; endTimes = <span class="keyword">new</span> PriorityQueue&lt;Integer&gt;();</div><div class="line">        endTimes.offer(intervals[<span class="number">0</span>].end);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; intervals.length; i++)&#123;</div><div class="line">            <span class="comment">// 如果当前时间段的开始时间大于最早结束的时间，则可以更新这个最早的结束时间为当前时间段的结束时间，如果小于的话，就加入一个新的结束时间，表示新的房间</span></div><div class="line">            <span class="keyword">if</span>(intervals[i].start &gt;= endTimes.peek())&#123;</div><div class="line">                endTimes.poll();</div><div class="line">            &#125;</div><div class="line">            endTimes.offer(intervals[i].end);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 有多少结束时间就有多少房间</span></div><div class="line">        <span class="keyword">return</span> endTimes.size();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/05/System Design_大型网站架构发展c1/" itemprop="url">
                  System Design_大型网站架构发展
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">發表於</span>
            <time itemprop="dateCreated" datetime="2015-11-05T00:00:00+09:00" content="2015-11-05">
              2015-11-05
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/System-design/" itemprop="url" rel="index">
                    <span itemprop="name">System design</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/11/05/System Design_大型网站架构发展c1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/11/05/System Design_大型网站架构发展c1/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="大型网站架构发展"><a href="#大型网站架构发展" class="headerlink" title="大型网站架构发展"></a>大型网站架构发展</h1><p>大型网站的技术挑战主要来自于庞大的用户，高并发的访问和海量的数据，任何简单的业务一旦需要处理以P计的数据和数亿的用户，就会变得很棘手，这也是大型网站架构需要解决的问题。</p>
<h2 id="初始阶段的网站架构"><a href="#初始阶段的网站架构" class="headerlink" title="初始阶段的网站架构"></a>初始阶段的网站架构</h2><p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c1_1.png" alt="System_design_c1_1"></p>
<p>由于用户量并不大，可以直接将应用程序、数据库、文件等所有资源放在一台服务器上。</p>
<h2 id="应用服务和数据服务分离"><a href="#应用服务和数据服务分离" class="headerlink" title="应用服务和数据服务分离"></a>应用服务和数据服务分离</h2><p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c1_2.png" alt="System_design_c1_"></p>
<p>需要将应用和数据分离，应用服务器需要处理大量的业务逻辑，需要强大的计算能力，数据库需要快速磁盘检索和数据缓存，所以需要更快的硬盘和更大的内存，文件服务器需要存储大量文件以及文件检索，需要更大的硬盘和内存。这样也方便扩展增加服务器。</p>
<h2 id="使用缓存改善网站性能"><a href="#使用缓存改善网站性能" class="headerlink" title="使用缓存改善网站性能"></a>使用缓存改善网站性能</h2><p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c1_3.png" alt="System_design_c1_3"></p>
<p>80%的业务集中在20%的数据上，如果将热门的数据缓存在内存中，可以很大的改善网站的相应速度。缓存可以分为两种，本地缓存和专门的分布式缓存服务器，考虑到扩展性，一般使用远程分布式缓存，以集群的方式部署大内存的服务器作为专门的缓存服务器。</p>
<h2 id="使用应用服务器集群改善网站的并发处理能力。"><a href="#使用应用服务器集群改善网站的并发处理能力。" class="headerlink" title="使用应用服务器集群改善网站的并发处理能力。"></a>使用应用服务器集群改善网站的并发处理能力。</h2><p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c1_4.png" alt=""></p>
<p>使用集群是完整解决高并发、海量数据的常用手段，也就是横向扩展(通过增加机器的方式扩展，与之相对的是纵向扩展，也就是通过增强一台机器的性能进行扩展)。对于大型网站而言，不管多强大的服务器，都无法满足持续增长的业务需求，这种情况下，更恰当的做法是增加一台服务器分担原有服务器的压力。</p>
<p>通过这种方式可以持续增加服务器不断改善系统性能，从而实现系统的可伸缩性。应用服务器实现集群也是网站可伸缩性集群架构设计中较简单成熟的一种。</p>
<h2 id="数据库读写分离"><a href="#数据库读写分离" class="headerlink" title="数据库读写分离"></a>数据库读写分离</h2><p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c1_5.png" alt=""></p>
<p>网站使用缓存后，可以很大程度减轻数据库的压力，但随着用户的进一步增加，数据库仍会因为负载压力过高成为网站的瓶颈，需要数据库读写分离来减轻负载。</p>
<p>应用服务其在写数据时，访问主数据库，主数据库通过主从复制将数据同步到从数据库，这样当应用服务器读数据的时候，就可以通过从数据库获得数据，</p>
<h2 id="使用反向代理和CDN加速网站响应"><a href="#使用反向代理和CDN加速网站响应" class="headerlink" title="使用反向代理和CDN加速网站响应"></a>使用反向代理和CDN加速网站响应</h2><p>CDN和反向代理的基本原理都是缓存，区别在于CDB部署在网络提供商的机房，反向代理则部署在网站的中心机房，当用户到达中心机房后，首先访问反向代理服务器，如果反向代理服务器中缓存着用户请求的资源，就将其直接诶返回给用户。</p>
<p>一方面可以加快访问速度，也可以减轻后端服务器的压力。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c1_6.png" alt=""></p>
<h2 id="使用分布式文件系统和分布式数据库系统"><a href="#使用分布式文件系统和分布式数据库系统" class="headerlink" title="使用分布式文件系统和分布式数据库系统"></a>使用分布式文件系统和分布式数据库系统</h2><p>分布式数据库系统是网站数据库拆分的最后手段，只有在单表数据规模¥非常大是才使用。一般网站更常用的数据库拆分手段是<strong>业务分库</strong>，将不同业务的数据库部署到不同的数据库服务器上。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c1_7.png" alt=""></p>
<h2 id="使用NoSQL和搜索引擎"><a href="#使用NoSQL和搜索引擎" class="headerlink" title="使用NoSQL和搜索引擎"></a>使用NoSQL和搜索引擎</h2><p>随着网站业务越累越复杂，对数据存储和检索的需求也越来越复杂，网站需要使用一些非关系数据库技术如NoSQL和非数据库查询技术如搜索引擎。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c1_8.png" alt=""></p>
<p>NoSQL和搜索引擎都对可伸缩的分布式特性具有很好的支持。应用服务器则通过一个统一的数据访问模块访问各种数据，减轻应用程序管理多数据源的问题。</p>
<h2 id="业务拆分"><a href="#业务拆分" class="headerlink" title="业务拆分"></a>业务拆分</h2><p>大型网站为了应对日益复杂的业务场景，通过分而治之的手段将整个网站业务分成不同的产品线，如首页，支付，订单，卖家，买家等，分到不同的业务团队负责。</p>
<p>具体到技术上，也会根据产品线划分，将一个网站拆分成许多不同的应用，每个应用独立部署，应用之间可以通过超链接建立关系，也可以通过消息队列进行数据分发，最常用的还是通过访问同一个存储系统来构成一个关联的完整系统。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c1_9.png" alt=""></p>
<h2 id="分布式服务"><a href="#分布式服务" class="headerlink" title="分布式服务"></a>分布式服务</h2><p>随着业务拆分越累越小，存储系统越来越大，应用系统的整体复杂度呈指数增加，部署维护困难。由于所有的应用要和所有数据库系统连接，这些连接是服务器规模的平方，会导致数据库资源不够。</p>
<p>由于很多子应用系统都需要进行很多相同的业务操作，如用户管理，商品管理等，可以将这些公用的服务提取出来，独立部署，有这些可复用的业务连接数据库，并对外提供公共服务。应用系统只需要通过分布式服务调用公共业务服务完成具体业务操作。</p>
<p><img src="http://7xs07u.com1.z0.glb.clouddn.com/System_design_c1_10.png" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/02/Leetcode_Shortest Word Distance/" itemprop="url">
                  Shortest Word Distance
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">發表於</span>
            <time itemprop="dateCreated" datetime="2015-11-02T00:00:00+09:00" content="2015-11-02">
              2015-11-02
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/11/02/Leetcode_Shortest Word Distance/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/11/02/Leetcode_Shortest Word Distance/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Shortest-Word-Distance"><a href="#Shortest-Word-Distance" class="headerlink" title="Shortest Word Distance"></a>Shortest Word Distance</h1><h2 id="Shortest-Word-Distance-1"><a href="#Shortest-Word-Distance-1" class="headerlink" title="Shortest Word Distance"></a><a href="http://segmentfault.com/a/1190000003906667" target="_blank" rel="external">Shortest Word Distance</a></h2><blockquote>
<p>Given a list of words and two words word1 and word2, return the shortest distance between these two words in the list.</p>
<p>For example, Assume that words = [“practice”, “makes”, “perfect”, “coding”, “makes”].</p>
<p>Given word1 = “coding”, word2 = “practice”, return 3. Given word1 = “makes”, word2 = “coding”, return 1.</p>
<p>Note: You may assume that word1 does not equal to word2, and word1 and word2 are both in the list.</p>
</blockquote>
<h2 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h2><p><a href="http://segmentfault.com/a/1190000003906667" target="_blank" rel="external">Shortest Word Distance</a><br><a href="http://blog.csdn.net/crazy__chen/article/details/47859737" target="_blank" rel="external">Shortest Word Distance</a></p>
<p>双指针法.<br>一个指针指向word1上次出现的位置，一个指针指向word2上次出现的位置。</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">shortestDistance</span><span class="params">(String[] words, String word1, String word2)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (words == <span class="keyword">null</span>) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> idx1 = -<span class="number">1</span>, idx2 = -<span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> diff = words.length;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; words.length; i++) &#123;</div><div class="line">            <span class="keyword">if</span> (words[i].equals(word1)) &#123;</div><div class="line">                idx1 = i;                </div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (words[i].equals(word2)) &#123;</div><div class="line">                idx2 = i;                </div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(idx1!=-<span class="number">1</span>&amp;&amp;idx2!=-<span class="number">1</span>)&#123;</div><div class="line">                diff = Math.min(diff,Math.abs(idx1-idx2));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> diff;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Shortest-Word-Distance-II"><a href="#Shortest-Word-Distance-II" class="headerlink" title="Shortest Word Distance II"></a><a href="">Shortest Word Distance II</a></h2><blockquote>
<p>This is a follow up of Shortest Word Distance. The only difference is now you are given the list of words and your method will be called repeatedly many times with different parameters. How would you optimize<br>it?</p>
<p>Design a class which receives a list of words in the constructor, and implements a method that takes two<br>words word1 and word2 and return the shortest distance between these two words in the list.</p>
<p>For example,<br>Assume that words = [“practice”, “makes”, “perfect”, “coding”, “makes”] .<br>Given word1 = “coding” , word2 = “practice” , return 3. Given word1 = “makes” , word2 =<br>“coding” , return 1.</p>
<p>Note: You may assume that word1 does not equal to word2, and word1 and word2 are both in the list.</p>
</blockquote>
<h2 id="Method-1"><a href="#Method-1" class="headerlink" title="Method"></a>Method</h2><p><a href="http://blog.csdn.net/crazy__chen/article/details/47859865" target="_blank" rel="external">Shortest Word Distance II</a></p>
<p>在构造函数，使用hashMap来记录每个单词的位置.</p>
<p>在计算最短距离的函数中，两个列表是已排序的，因此可使用类似MergeSort的思路求解最短距离。 </p>
<h2 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WordDistance</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> HashMap&lt;String, List&lt;Integer&gt;&gt; indexer = <span class="keyword">new</span> HashMap&lt;String, List&lt;Integer&gt;&gt;();</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WordDistance</span><span class="params">(String[] words)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (words == <span class="keyword">null</span>) <span class="keyword">return</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; words.length; i++) &#123;</div><div class="line">            <span class="keyword">if</span> (indexer.containsKey(words[i])) &#123;</div><div class="line">                indexer.get(words[i]).add(i);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                List&lt;Integer&gt; positions = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</div><div class="line">                positions.add(i);</div><div class="line">                indexer.put(words[i], positions);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">shortest</span><span class="params">(String word1, String word2)</span> </span>&#123;</div><div class="line">        List&lt;Integer&gt; posList1 = indexer.get(word1);</div><div class="line">        List&lt;Integer&gt; posList2 = indexer.get(word2);</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> diff = Integer.MAX_VALUE;</div><div class="line">        <span class="keyword">while</span> (i &lt; posList1.size() &amp;&amp; j &lt; posList2.size()) &#123;</div><div class="line">            <span class="keyword">int</span> pos1 = posList1.get(i), pos2 = posList2.get(j);</div><div class="line">            <span class="keyword">if</span> (pos1 &lt; pos2) &#123;</div><div class="line">                diff = Math.min(diff, pos2 - pos1);</div><div class="line">                i++;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                diff = Math.min(diff, pos1 - pos2);</div><div class="line">                j++;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> diff;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Shortest-Word-Distance-III"><a href="#Shortest-Word-Distance-III" class="headerlink" title="Shortest Word Distance III"></a><a href="">Shortest Word Distance III</a></h2><blockquote>
<p>This is a follow up of Shortest Word Distance. The only difference is now word1 could be the same as word2.</p>
<p>Given a list of words and two words word1 and word2, return the shortest distance between these two words in the list.</p>
<p>word1 and word2 may be the same and they represent two individual words in the list.</p>
<p>For example,<br>Assume that words = [“practice”, “makes”, “perfect”, “coding”, “makes”].</p>
<p>Given word1 = “makes”, word2 = “coding”, return 1.<br>Given word1 = “makes”, word2 = “makes”, return 3.</p>
<p>Note:<br>You may assume word1 and word2 are both in the list.</p>
</blockquote>
<h2 id="Method-2"><a href="#Method-2" class="headerlink" title="Method"></a>Method</h2><p>解法基本与I相同，需要加一个是否是同一位置的判断。 </p>
<h2 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">shortestWordDistance</span><span class="params">(String[] words, String word1, String word2)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> p1 = -<span class="number">1</span>, p2 = -<span class="number">1</span>, distance = words.length;</div><div class="line">        </div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;words.length; i++)&#123;</div><div class="line">            <span class="keyword">if</span>(words[i].equals(word1))&#123;</div><div class="line">                p1 = i;</div><div class="line">                <span class="keyword">if</span>(p1 != -<span class="number">1</span> &amp;&amp; p2 != -<span class="number">1</span>)&#123;</div><div class="line">                    distance = (p1!=p2) ? Math.min(distance, Math.abs(p1-p2)): distance;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(words[i].equals(word2))&#123;</div><div class="line">                p2 = i;</div><div class="line">                <span class="keyword">if</span>(p1 != -<span class="number">1</span> &amp;&amp; p2 != -<span class="number">1</span>)&#123;</div><div class="line">                    distance = (p1!=p2) ? Math.min(distance, Math.abs(p1-p2)): distance;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> distance;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/66/">66</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/plusaber.jpg"
               alt="Plusaber" />
          <p class="site-author-name" itemprop="name">Plusaber</p>
          <p class="site-description motion-element" itemprop="description">Plusaber's Blog</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">329</span>
              <span class="site-state-item-name">文章</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">分類</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">52</span>
                <span class="site-state-item-name">標籤</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.kaggle.com" title="Kaggle" target="_blank">Kaggle</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.algolia.com" title="Algolia" target="_blank">Algolia</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://jp.linkedin.com/in/zebangchen" title="LinkedIn" target="_blank">LinkedIn</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://portal.qiniu.com" title="Qiniu" target="_blank">Qiniu</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2014 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Plusaber</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 強力驅動
</div>

<div class="theme-info">
  主題 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'plusaber';
      var disqus_identifier = 'page/6/index.html';
      var disqus_title = "";
      var disqus_url = '';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
    </script>
  




  
  

  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>
  <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->


  

  

  


</body>
</html>
